'use strict';window.tsfTitle=function(a){const b="undefined"!=typeof tsfTitleL10n&&tsfTitleL10n;let c,d={allowReferenceChange:!0,useTagline:b.states.useTagline,separator:b.states.titleSeparator,additionPlacement:b.states.additionPlacement,prefixPlacement:b.states.prefixPlacement,additionValue:tsf.escapeString(b.states.additionValue.trim()),prefixValue:"",defaultTitle:tsf.escapeString(b.states.defaultTitle.trim())};const e=tsf.escapeString(b.params.untitledTitle);let f="",g="";const h=document.getElementById("tsf-title-placeholder-prefix")||a("</span>")[0],i=document.getElementById("tsf-title-placeholder")||a("</span>")[0],j=a=>a?a in d?d[a]:void 0:d,k=()=>{let a="",b="";if(d.useTagline&&(b=d.additionValue),b)switch(d.additionPlacement){case"before":a=b+" "+d.separator+" ";break;case"after":a=" "+d.separator+" "+b;}f=a||"",i.innerHTML=f},l=()=>{let a="",b=d.prefixValue.trim();if(b)switch(d.prefixPlacement){case"before":a=b+" ";break;case"after":a=" "+b;}g=a||"",h.innerHTML=g},m=function(b){if(!i&&!h)return;let c=a(b.target),e=c.val(),j=!!f.length,k=!!g.length;if(!j&&i&&(i.style.display="none"),!k&&h&&(h.style.display="none"),!j&&!k)return void c.css("text-indent","initial");if(!e.length)return c.css("text-indent","initial"),i&&(i.style.display="none"),void(h&&(h.style.display="none"));let l=c.outerWidth(!0),m=(c.outerHeight(!0)-c.height())/2,n=(l-c.innerWidth())/2,o=tsf.l10n.states.isRTL?"right":"left",p=(c.outerWidth(!0)-c.width())/2,q={display:c.css("display"),lineHeight:c.css("lineHeight"),fontFamily:c.css("fontFamily"),fontWeight:c.css("fontWeight"),fontSize:c.css("fontSize"),letterSpacing:c.css("letterSpacing"),paddingTop:m+"px",paddingBottom:m+"px"},r=a(h),s=a(i),t=0,u=0,v=0,w=0,x=0,y=0;if(k&&(r.css(q),r.css({maxWidth:"initial"}),x=r[0].getBoundingClientRect().width,x<y&&(x=0)),j){let b=0;switch((()=>{let c=a("#tsf-title-offset");c.text(e),c.css({fontFamily:q.fontFamily,fontWeight:q.fontWeight,letterSpacing:q.letterSpacing,fontSize:q.fontSize}),b=c[0].getBoundingClientRect().width})(),t=c[0].getBoundingClientRect().width-n-p-b-x,t<y&&(x+=t,t=0),s.css(q),s.css({maxWidth:"initial"}),d.additionPlacement){case"before":let f=s[0].getBoundingClientRect().width;f=t<f?t:f,f<y&&(f=0),t=f,w+=t,v+=t,u+=p;break;case"after":u+=p+b+x;}}v+=p,x=0>x?0:x,w+=x;let z;k&&(z={},z[o]=v+"px",z.maxWidth=x+"px",r.css(z)),j&&(z={},z[o]=u+"px",z.maxWidth=t+"px",s.css(z)),z={},z["text-indent"]=w+"px",c.css(z)},n=b=>{let c=document.getElementById("tsf-title-reference"),e=d.allowReferenceChange&&b.target.value||d.defaultTitle;if(c){if(e=e.trim(),1>e.length||!d.allowReferenceChange)e=b.target.placeholder;else{if(g.length)switch(d.additionPlacement){case"before":e=g+e;break;case"after":e+=g;}if(f.length)switch(d.additionPlacement){case"before":e=f+e;break;case"after":e+=f;}}c.innerHTML=tsf.escapeString(tsf.decodeEntities(tsf.sDoubleSpace(e.trim()))),setTimeout(()=>{a(c).change()},0)}},o=a=>{!d.allowReferenceChange||a.target.value||(a.target.placeholder=document.getElementById("tsf-title-reference").innerText)},p=a=>{let b=document.getElementById(a.target.id+"_chars"),c=document.getElementById("tsf-title-reference");b&&tsfC&&tsfC.updateCharacterCounter({e:b,text:c.innerHTML,field:"title",type:"search"})},q=a=>{let b=document.getElementById(a.target.id+"_pixels"),c=document.getElementById("tsf-title-reference");b&&tsfC&&tsfC.updatePixelCounter({e:b,text:c.innerHTML,field:"title",type:"search"})},r=()=>{a(c).trigger("input.tsfUpdateTitles")},s=()=>{a(c).trigger("tsf-update-title-counter")},t=a=>{m(a),n(a),o(a),u(a)},u=a=>{p(a),q(a)};let v=0;const w=()=>{clearTimeout(v),v=setTimeout(r,10)},x=()=>{if(!tsfAys)r();else{let a=tsfAys.getChangedState;r(),a||tsfAys.reset()}};let y=0;const z=()=>{clearTimeout(y),y=setTimeout(x,10)},A=b=>{let c=a(b.target).siblings("input").first();if(c.length){let a=c[0];switch(a.focus(),b.detail){case 3:a.setSelectionRange(0,a.value.length);break;case 2:let c,e;"tsf-title-placeholder"===b.target.id&&"after"===d.additionPlacement||"tsf-title-placeholder-prefix"===b.target.id&&tsf.l10n.states.isTRL?(c=a.value.replace(/([0-9A-Z_a-z]+|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)$/u,"").length,e=a.value.length):(c=0,e=a.value.length-a.value.replace(/^([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+|[0-9A-Z_a-z]+)/u,"").length),a.setSelectionRange(c,e);break;case 1:default:let f="tsf-title-placeholder"===b.target.id&&"after"===d.additionPlacement?a.value.length:0;a.setSelectionRange(f,f);}}};let B=window.innerWidth;const C=()=>{let a=window.innerWidth;B<a?782>=B&&782<=a&&x():782<=B&&782>=a&&x(),B=a},D=()=>{h.addEventListener("click",A),i.addEventListener("click",A),a(document).on("wp-window-resized",C),a(window).on("tsf-counter-updated",w)},E=()=>{!c instanceof Element||(a(c).on("input.tsfUpdateTitles",t),a(c).on("tsf-update-title-counter",u),k(),l(),z())};return Object.assign({load:()=>{a(document.body).on("tsf-onload",D),a(document.body).on("tsf-ready",E)}},{setInputElement:a=>{c=a},getState:j,updateState:(a,b)=>{switch(d[a]=b,a){case"prefixValue":case"prefixPlacement":l(),w();break;case"useTagline":case"separator":case"additionValue":case"additionPlacement":k(),w();break;case"allowReferenceChange":case"defaultTitle":default:w();}},triggerCounter:s,triggerInput:r,enqueueTriggerInput:w,triggerUnregisteredInput:x,enqueueUnregisteredInputTrigger:z},{l10n:b,untitledTitle:e})}(jQuery),jQuery(window.tsfTitle.load);
